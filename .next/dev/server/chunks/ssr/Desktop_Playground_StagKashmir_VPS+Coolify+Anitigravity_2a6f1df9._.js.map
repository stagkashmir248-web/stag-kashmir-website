{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suhail%20-%20CGIT/Desktop/Playground_StagKashmir_VPS%2BCoolify%2BAnitigravity/src/actions/order.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { PrismaClient } from \"@prisma/client\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nconst prisma = new PrismaClient();\r\n\r\ninterface CustomerDetails {\r\n    name: string;\r\n    email: string;\r\n    phone: string;\r\n}\r\n\r\ninterface CartItemInput {\r\n    productId: string;\r\n    quantity: number;\r\n    price: number;\r\n}\r\n\r\nexport async function submitOrder(\r\n    customer: CustomerDetails,\r\n    items: CartItemInput[],\r\n    total: number\r\n) {\r\n    try {\r\n        if (!customer.name || !customer.email || !customer.phone) {\r\n            return { success: false, error: \"All customer fields are required.\" };\r\n        }\r\n\r\n        if (!items || items.length === 0) {\r\n            return { success: false, error: \"Cannot submit an empty order.\" };\r\n        }\r\n\r\n        // Create the order and its items in a single transaction\r\n        const order = await prisma.order.create({\r\n            data: {\r\n                customer: customer.name,\r\n                email: customer.email,\r\n                phone: customer.phone,\r\n                total: total,\r\n                status: \"PENDING\", // Default status for unpaid inquiries\r\n                items: {\r\n                    create: items.map((item) => ({\r\n                        quantity: item.quantity,\r\n                        price: item.price,\r\n                        product: {\r\n                            connect: { id: item.productId },\r\n                        },\r\n                    })),\r\n                },\r\n            },\r\n        });\r\n\r\n        console.log(`Order created successfully: ${order.id}`);\r\n\r\n        // Optional: Revalidate the admin dashboard path later\r\n        revalidatePath(\"/admin/orders\");\r\n\r\n        return { success: true, orderId: order.id };\r\n    } catch (error) {\r\n        console.error(\"Failed to submit order:\", error);\r\n        return {\r\n            success: false,\r\n            error: \"An error occurred while submitting your order. Please try again.\",\r\n        };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,0QAAY;AAcxB,eAAe,YAClB,QAAyB,EACzB,KAAsB,EACtB,KAAa;IAEb,IAAI;QACA,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,KAAK,EAAE;YACtD,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAoC;QACxE;QAEA,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;YAC9B,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAgC;QACpE;QAEA,yDAAyD;QACzD,MAAM,QAAQ,MAAM,OAAO,KAAK,CAAC,MAAM,CAAC;YACpC,MAAM;gBACF,UAAU,SAAS,IAAI;gBACvB,OAAO,SAAS,KAAK;gBACrB,OAAO,SAAS,KAAK;gBACrB,OAAO;gBACP,QAAQ;gBACR,OAAO;oBACH,QAAQ,MAAM,GAAG,CAAC,CAAC,OAAS,CAAC;4BACzB,UAAU,KAAK,QAAQ;4BACvB,OAAO,KAAK,KAAK;4BACjB,SAAS;gCACL,SAAS;oCAAE,IAAI,KAAK,SAAS;gCAAC;4BAClC;wBACJ,CAAC;gBACL;YACJ;QACJ;QAEA,QAAQ,GAAG,CAAC,CAAC,4BAA4B,EAAE,MAAM,EAAE,EAAE;QAErD,sDAAsD;QACtD,IAAA,mNAAc,EAAC;QAEf,OAAO;YAAE,SAAS;YAAM,SAAS,MAAM,EAAE;QAAC;IAC9C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;YACH,SAAS;YACT,OAAO;QACX;IACJ;AACJ;;;IA/CsB;;AAAA,mTAAA"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suhail%20-%20CGIT/Desktop/Playground_StagKashmir_VPS%2BCoolify%2BAnitigravity/.next-internal/server/app/checkout/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {submitOrder as '70cd94455380060f431b06371f961677d100c23dfc'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}