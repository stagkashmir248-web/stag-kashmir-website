{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suhail%20-%20CGIT/Desktop/Playground_StagKashmir_VPS%2BCoolify%2BAnitigravity/src/actions/admin-product.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { PrismaClient } from \"@prisma/client\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nexport async function deleteProduct(productId: string) {\r\n    try {\r\n        // Note: In a real app we might prevent deletion if it's tied to an order, \r\n        // or use soft deletes. For this MVP, we allow raw deletion.\r\n        await prisma.product.delete({\r\n            where: { id: productId },\r\n        });\r\n\r\n        revalidatePath(\"/admin/products\");\r\n        revalidatePath(\"/shop\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error(\"Failed to delete product:\", error);\r\n        return { success: false, error: \"Failed to delete product.\" };\r\n    }\r\n}\r\n\r\nexport async function createProduct(data: {\r\n    name: string;\r\n    slug: string;\r\n    description: string;\r\n    price: number;\r\n    stock: number;\r\n    imageUrl?: string;\r\n}) {\r\n    try {\r\n        const product = await prisma.product.create({\r\n            data: {\r\n                name: data.name,\r\n                slug: data.slug,\r\n                description: data.description,\r\n                price: data.price,\r\n                stock: data.stock,\r\n                imageUrl: data.imageUrl,\r\n            },\r\n        });\r\n\r\n        revalidatePath(\"/admin/products\");\r\n        revalidatePath(\"/shop\");\r\n        return { success: true, product };\r\n    } catch (error) {\r\n        console.error(\"Failed to create product:\", error);\r\n        // Prisma unique constraint validation\r\n        if (error && typeof error === 'object' && 'code' in error && error.code === 'P2002') {\r\n            return { success: false, error: \"A product with this slug already exists.\" };\r\n        }\r\n        return { success: false, error: \"Failed to create product.\" };\r\n    }\r\n}\r\n\r\nexport async function updateProduct(id: string, data: {\r\n    name: string;\r\n    slug: string;\r\n    description: string;\r\n    price: number;\r\n    stock: number;\r\n    imageUrl?: string;\r\n}) {\r\n    try {\r\n        const product = await prisma.product.update({\r\n            where: { id },\r\n            data: {\r\n                name: data.name,\r\n                slug: data.slug,\r\n                description: data.description,\r\n                price: data.price,\r\n                stock: data.stock,\r\n                ...(data.imageUrl && { imageUrl: data.imageUrl }), // Only update image if provided\r\n            },\r\n        });\r\n\r\n        revalidatePath(\"/admin/products\");\r\n        revalidatePath(\"/shop\");\r\n        revalidatePath(`/shop/${product.slug}`);\r\n        return { success: true, product };\r\n    } catch (error) {\r\n        console.error(\"Failed to update product:\", error);\r\n        // Prisma unique constraint validation\r\n        if (error && typeof error === 'object' && 'code' in error && error.code === 'P2002') {\r\n            return { success: false, error: \"A product with this slug already exists.\" };\r\n        }\r\n        return { success: false, error: \"Failed to update product.\" };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,0QAAY;AAExB,eAAe,cAAc,SAAiB;IACjD,IAAI;QACA,2EAA2E;QAC3E,4DAA4D;QAC5D,MAAM,OAAO,OAAO,CAAC,MAAM,CAAC;YACxB,OAAO;gBAAE,IAAI;YAAU;QAC3B;QAEA,IAAA,mNAAc,EAAC;QACf,IAAA,mNAAc,EAAC;QACf,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAChE;AACJ;AAEO,eAAe,cAAc,IAOnC;IACG,IAAI;QACA,MAAM,UAAU,MAAM,OAAO,OAAO,CAAC,MAAM,CAAC;YACxC,MAAM;gBACF,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW;gBAC7B,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;YAC3B;QACJ;QAEA,IAAA,mNAAc,EAAC;QACf,IAAA,mNAAc,EAAC;QACf,OAAO;YAAE,SAAS;YAAM;QAAQ;IACpC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,sCAAsC;QACtC,IAAI,SAAS,OAAO,UAAU,YAAY,UAAU,SAAS,MAAM,IAAI,KAAK,SAAS;YACjF,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA2C;QAC/E;QACA,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAChE;AACJ;AAEO,eAAe,cAAc,EAAU,EAAE,IAO/C;IACG,IAAI;QACA,MAAM,UAAU,MAAM,OAAO,OAAO,CAAC,MAAM,CAAC;YACxC,OAAO;gBAAE;YAAG;YACZ,MAAM;gBACF,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW;gBAC7B,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;gBACjB,GAAI,KAAK,QAAQ,IAAI;oBAAE,UAAU,KAAK,QAAQ;gBAAC,CAAC;YACpD;QACJ;QAEA,IAAA,mNAAc,EAAC;QACf,IAAA,mNAAc,EAAC;QACf,IAAA,mNAAc,EAAC,CAAC,MAAM,EAAE,QAAQ,IAAI,EAAE;QACtC,OAAO;YAAE,SAAS;YAAM;QAAQ;IACpC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,sCAAsC;QACtC,IAAI,SAAS,OAAO,UAAU,YAAY,UAAU,SAAS,MAAM,IAAI,KAAK,SAAS;YACjF,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA2C;QAC/E;QACA,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAChE;AACJ;;;IAnFsB;IAiBA;IAiCA;;AAlDA,mTAAA;AAiBA,mTAAA;AAiCA,mTAAA"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suhail%20-%20CGIT/Desktop/Playground_StagKashmir_VPS%2BCoolify%2BAnitigravity/.next-internal/server/app/admin/products/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {deleteProduct as '40eaa28daee12ba803b965525c203cfa04fff70859'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}